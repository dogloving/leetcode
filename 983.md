```CPP
class Solution {
public:
    int mincostTickets(vector<int>& days, vector<int>& costs) {
        vector<int> dp = {0};
        for (int i = 0; i < days.size(); ++i) {
            dp.push_back(dp.back()+min(costs[0],min(costs[1],costs[2])));
            int j = i-1;
            for (; j >= 0; --j) {
                if (days[i]-days[j]>=7) break;
                dp[i+1] = min(dp[i+1], dp[j]+costs[1]);
            }
            for (; j >= 0; --j) {
                if (days[i]-days[j]>=30) break;
                dp[i+1] = min(dp[i+1], dp[j]+costs[2]);
            }
        }
        return dp.back();
    }
};
```

